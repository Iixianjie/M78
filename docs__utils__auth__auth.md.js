(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[45],{"5vbs":function(e,n,t){"use strict";t.r(n);var a=t("q1tI"),l=t.n(a),r=t("dEAq"),c=t("Zxc8"),u=t("H1Ra"),o=t("Rsk4"),m=l.a.memo(o["default"]["auth-base-demo"].component),i=l.a.memo(o["default"]["auth-feedback-type-demo"].component),d=l.a.memo(o["default"]["auth-with-auth-demo"].component),s=l.a.memo(o["default"]["auth-use-auth-demo"].component),h=l.a.memo(o["default"]["auth-or-demo"].component),E=l.a.memo(o["default"]["auth-extra-demo"].component),p=l.a.memo(o["default"]["auth-custom-demo"].component),A=l.a.memo(o["default"]["auth-scope-demo"].component),k=l.a.memo(o["default"]["pro-base"].component);n["default"]=e=>(l.a.useEffect(()=>{var n;(null===e||void 0===e||null===(n=e.location)||void 0===n?void 0:n.hash)&&r["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))},[]),l.a.createElement(l.a.Fragment,null,l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"markdown"},l.a.createElement("h1",{id:"auth-\u6743\u9650"},l.a.createElement(r["AnchorLink"],{to:"#auth-\u6743\u9650","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Auth \u6743\u9650"),l.a.createElement("p",null,"\u6b64\u5e93\u5305\u542b\u4e24\u79cd\u6743\u9650\u5b9e\u73b0:"),l.a.createElement("ol",null,l.a.createElement("li",null,"\u5e38\u89c4\u7248\u672c\uff0c\u9a8c\u8bc1\u901a\u8fc7\u672c\u5730\u9a8c\u8bc1\u5668\u548c\u4e00\u7ec4",l.a.createElement(r["Link"],{to:"/docs/utils/seed"},l.a.createElement("code",null,"seed")),"\u72b6\u6001\u6765\u5b9e\u73b0, \u9002\u5408\u7528\u6765\u5b8c\u6210\u4e2d\u5c11\u91cf\u6743\u9650\u7684\u63a7\u5236\u3002"),l.a.createElement("li",null,"Pro \u7248\u672c\uff0c\u901a\u8fc7\u8fdb\u4e00\u6b65\u7684\u5c01\u88c5\u7b80\u5316\u4e86 api \u7684\u6574\u4f53\u4f7f\u7528\uff0c\u9002\u5408\u5305\u542b\u5927\u91cf\u590d\u6742\u6743\u9650\u903b\u8f91\u7684\u4e2d\u540e\u53f0\u9879\u76ee\uff0c\u5e76\u4e14\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u7684\u548c\u4efb\u610f\u540e\u7aef\u4f53\u7cfb\u96c6\u6210\u3002")),l.a.createElement("br",null),l.a.createElement("p",null,"\u4e24\u79cd\u6743\u9650\u975e\u5e38\u9002\u5408\u6df7\u5408\u4f7f\u7528\uff0c\u6bd4\u5982\u5728\u4e00\u4e2a\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u4e2d\uff0c\u5e38\u89c4\u7248\u672c\u7684\u6743\u9650\u63a7\u5236\u5f88\u9002\u5408\u7528\u6765\u8fdb\u884c\u8fdb\u884c\u767b\u5f55\u3001\u8d26\u53f7\u72b6\u6001\u7b49\u9a8c\u8bc1\uff0c\u800c Pro \u7248\u672c\u7684\u6743\u9650\u9a8c\u8bc1\u5219\u53ef\u4ee5\u7528\u6765\u5b8c\u6210\u8def\u7531\u3001\u7ec4\u4ef6\u3001\u6309\u94ae\u7ea7\u522b\u7684\u6743\u9650\u63a7\u5236\u3002"),l.a.createElement("h2",{id:"auth"},l.a.createElement(r["AnchorLink"],{to:"#auth","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"Auth"),l.a.createElement("p",null,"\u5e38\u89c4\u7248\u672c\u9a8c\u8bc1\u51fd\u6570\uff0c\u9002\u5408\u7528\u6765\u8fdb\u884c\u4e00\u4e9b\u788e\u7247\u5316\u9a8c\u8bc1\u7684\u6743\u9650\u9a8c\u8bc1\u3002"),l.a.createElement("h3",{id:"\u57fa\u672c\u793a\u4f8b"},l.a.createElement(r["AnchorLink"],{to:"#\u57fa\u672c\u793a\u4f8b","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u57fa\u672c\u793a\u4f8b"),l.a.createElement("p",null,"\u521b\u5efa seed \u5b9e\u4f8b\u5e76\u901a\u8fc7\u901a\u8fc7 Auth \u7ec4\u4ef6\u6765\u5bf9\u6307\u5b9a\u8282\u70b9\u9644\u52a0\u6743\u9650")),l.a.createElement(c["default"],o["default"]["auth-base-demo"].previewerProps,l.a.createElement(m,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"\u53cd\u9988\u65b9\u5f0f"},l.a.createElement(r["AnchorLink"],{to:"#\u53cd\u9988\u65b9\u5f0f","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u53cd\u9988\u65b9\u5f0f"),l.a.createElement("p",null,"\u65e0\u6743\u9650\u65f6\u6709\u4e09\u79cd\u53ef\u9009\u7684\u53cd\u9988\u65b9\u5f0f\uff1a\u5360\u4f4d\u8282\u70b9\u3001\u6c14\u6ce1\u6846\u63d0\u793a\u3001\u9690\u85cf")),l.a.createElement(c["default"],o["default"]["auth-feedback-type-demo"].previewerProps,l.a.createElement(i,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"withauth"},l.a.createElement(r["AnchorLink"],{to:"#withauth","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"withAuth"),l.a.createElement("p",null,"\u4e3a\u73b0\u6709\u7ec4\u4ef6\u9644\u52a0\u6743\u9650\u63a7\u5236\uff0c\u751f\u6210\u7684\u6743\u9650\u7ec4\u4ef6\u4f1a\u76f4\u63a5\u9644\u5e26\u6743\u9650\u9a8c\u8bc1\uff0c\u53ef\u7528\u4e8e\u8def\u7531\u7ec4\u4ef6\u7b49\u7684\u6743\u9650\u9a8c\u8bc1")),l.a.createElement(c["default"],o["default"]["auth-with-auth-demo"].previewerProps,l.a.createElement(d,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"useauth"},l.a.createElement(r["AnchorLink"],{to:"#useauth","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"useAuth"),l.a.createElement("p",null,"hooks \u5f0f\u7684\u9a8c\u8bc1\uff0c\u63a5\u53d7\u9a8c\u8bc1\u53c2\u6570\uff0c\u8fd4\u56de\u9a8c\u8bc1\u7ed3\u679c")),l.a.createElement(c["default"],o["default"]["auth-use-auth-demo"].previewerProps,l.a.createElement(s,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"or"},l.a.createElement(r["AnchorLink"],{to:"#or","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"or"),l.a.createElement("p",null,"\u7c7b\u4f3c\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684 ",l.a.createElement("code",null,"||"),"\uff0c\u5982\u679c\u9700\u8981\u5728\u4e24\u4e2a\u6743\u9650\u4e2d\u4efb\u610f\u4e00\u4e2a\u901a\u8fc7\u5c31\u901a\u8fc7\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u5c06\u6743\u9650 key \u8bbe\u7f6e\u4e3a\u4e8c\u7ef4\u6570\u7ec4",l.a.createElement("code",null,"['key', ['key2', 'key3']]"),"\xb7"),l.a.createElement("p",null,"\ud83d\udca1 \u4e0e\u5e38\u89c4\u9a8c\u8bc1\u5668\u4e0d\u540c\uff0c\u4e32\u8054\u7684 ",l.a.createElement("code",null,"\u6216\u9a8c\u8bc1\u5668")," \u4e0d\u4f1a\u5728\u524d\u9762\u7684\u9a8c\u8bc1\u5668\u6267\u884c\u5931\u8d25\u540e\u963b\u6b62\u540e\u9762\u7684\u540c\u7ea7\u9a8c\u8bc1\u5668\u6267\u884c")),l.a.createElement(c["default"],o["default"]["auth-or-demo"].previewerProps,l.a.createElement(h,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"\u989d\u5916\u53c2\u6570"},l.a.createElement(r["AnchorLink"],{to:"#\u989d\u5916\u53c2\u6570","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u989d\u5916\u53c2\u6570"),l.a.createElement("p",null,"\u67d0\u4e9b\u9a8c\u8bc1\u5668\u4f1a\u9700\u8981\u63a5\u53d7\u5f53\u524d\u8fd0\u884c\u65f6\u53c2\u6570\u4f5c\u4e3a\u9a8c\u8bc1\u53c2\u7167\uff08\u6bd4\u5982\u9a8c\u8bc1\u662f\u5426\u4e3a\u672c\u4eba\uff0c\u4f1a\u9700\u8981\u4f20\u5165\u5f53\u524d\u7528\u6237\u7684\u4fe1\u606f\u7ed9\u9a8c\u8bc1\u5668\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7 extra \u4f20\u9012")),l.a.createElement(c["default"],o["default"]["auth-extra-demo"].previewerProps,l.a.createElement(E,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"\u5b9a\u5236\u53cd\u9988\u8282\u70b9"},l.a.createElement(r["AnchorLink"],{to:"#\u5b9a\u5236\u53cd\u9988\u8282\u70b9","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u5b9a\u5236\u53cd\u9988\u8282\u70b9")),l.a.createElement(c["default"],o["default"]["auth-custom-demo"].previewerProps,l.a.createElement(p,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"\u5c40\u90e8\u9a8c\u8bc1\u5668"},l.a.createElement(r["AnchorLink"],{to:"#\u5c40\u90e8\u9a8c\u8bc1\u5668","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u5c40\u90e8\u9a8c\u8bc1\u5668"),l.a.createElement("p",null,"\u53ea\u4f5c\u7528\u4e8e\u5f53\u524d\u6302\u8f7d\u7ec4\u4ef6\u7684\u9a8c\u8bc1\u5668")),l.a.createElement(c["default"],o["default"]["auth-scope-demo"].previewerProps,l.a.createElement(A,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"api-\u901f\u89c8"},l.a.createElement(r["AnchorLink"],{to:"#api-\u901f\u89c8","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"api \u901f\u89c8"),l.a.createElement(u["a"],{code:"import { createSeed } from 'm78/seed';\nimport { createAuth } from 'm78/auth';\n\n// ###############################\n//            \u521b\u5efa\u5b9e\u4f8b\n// ###############################\n\n// \u521b\u5efa\u7528\u4e8e\u7ba1\u7406auth\u72b6\u6001\u7684seed\nconst seed = createSeed({\n  /* \u88ab\u6240\u6709\u9a8c\u8bc1\u5668\u4f9d\u8d56\u6570\u636e */\n  state: {\n    /** \u767b\u5f55\u7528\u6237 */\n    user: '',\n    /** \u662f\u5426\u662f\u7ba1\u7406\u5458 */\n    admin: 2,\n  },\n});\n\n// \u521b\u5efaAuth\u5b9e\u4f8b\nconst Auth = createAuth({\n  seed,\n  /* \u58f0\u660e\u9a8c\u8bc1\u5668 */\n  validators: {\n    // \u767b\u5f55\u72b6\u6001\u9a8c\u8bc1\u5668\n    login(state) {\n\n      // \u9a8c\u8bc1\u5668\u7684\u804c\u8d23\u5c31\u662f\u6839\u636e\u5f53\u524d\u7684state\u68c0\u6d4b\u662f\u5426\u5305\u542b\u6743\u9650\uff0c\u6ca1\u6709\u6743\u9650\u65f6\uff0c\u8fd4\u56de\u4e00\u7ec4\u63cf\u8ff0\u4fe1\u606f\n      if (!state.user) {\n        return {\n          label: '\u672a\u767b\u5f55',\n          desc: '\u8bf7\u767b\u5f55\u540e\u518d\u8fdb\u884c\u64cd\u4f5c',\n          actions: [...],\n        };\n      }\n    },\n    // ...\u66f4\u591a\u9a8c\u8bc1\u5668\n  },\n  /**\n   * \u5982\u679c\u4e00\u4e2a\u9a8c\u8bc1\u672a\u901a\u8fc7\uff0c\u5219\u963b\u6b62\u540e\u7eed\u9a8c\u8bc1\n   * * \u5bf9\u4e8eor\u4e2d\u7684\u5b50\u6743\u9650\uff0c\u5373\u4f7f\u5f00\u542f\u4e86validFirst\uff0c\u4f9d\u7136\u4f1a\u5bf9\u6bcf\u4e00\u9879\u8fdb\u884c\u9a8c\u8bc1\uff0c\u4f46\u662f\u53ea\u4f1a\u8fd4\u56de\u7b2c\u4e00\u4e2a\n   * * \u5728\u6267\u884cauth()\u65f6\u5c06\u4f18\u5148\u7ea7\u66f4\u9ad8\u7684\u6743\u9650key\u653e\u5230\u524d\u9762\u6709\u52a9\u4e8e\u63d0\u9ad8\u9a8c\u8bc1\u53cd\u9988\u7684\u7cbe\u5ea6, \u5982 login > publisher, \u56e0\u4e3apublisher\u72b6\u6001\u662f\u4ee5login\u4e3a\u524d\u63d0\u7684\n   *  */\n  validFirst?: boolean;\n});\n\n// ###############################\n//              API\n// ###############################\n\n// <Auth />\u672c\u8eab\u662f\u4e00\u4e2areact\u7ec4\u4ef6\uff0c\u5305\u542b\u4ee5\u4e0bprops\ninterface AuthProps<S, V> {\n  /**\n   * \u6743\u9650\u9a8c\u8bc1\u901a\u8fc7\u540e\u663e\u793a\u7684\u5185\u5bb9\n   * - \u5f53type\u4e3atooltip\u65f6\uff0c\u5fc5\u987b\u4f20\u5165\u5355\u4e2a\u5b50\u5143\u7d20\uff0c\u5e76\u4e14\u4fdd\u8bc1\u5176\u80fd\u6b63\u5e38\u63a5\u6536\u4e8b\u4ef6\n   * */\n  children: React.ReactElement | (() => React.ReactElement);\n  /**\n   * \u5f85\u9a8c\u8bc1\u7684\u6743\u9650key\u7ec4\u6210\u7684\u6570\u7ec4\n   * - \u53ea\u8981\u6709\u4e00\u4e2a\u6743\u9650\u672a\u9a8c\u8bc1\u901a\u8fc7\uff0c\u540e\u7eed\u9a8c\u8bc1\u5c31\u4f1a\u88ab\u4e2d\u65ad\uff0c\u6240\u4ee5key\u7684\u4f20\u5165\u987a\u5e8f\u6700\u597d\u6309\u4f18\u5148\u7ea7\u4ece\u5de6\u5230\u53f3\uff0c\u5982: ['login', 'isVip']\n   * - \u53ef\u4ee5\u901a\u8fc7\u4e8c\u7ef4\u6570\u7ec4\u6765\u7ec4\u5408\u4e24\u4e2a\u6761\u4ef6['key1', ['key2', 'key3']], \u7ec4\u5408\u7684\u6761\u4ef6\u8868\u793a\u903b\u8f91 `or` */\n  keys: AuthKeys<V>;\n  /** 'feedback' | \u53cd\u9988\u65b9\u5f0f\uff0c\u5206\u4e3a\u5360\u4f4d\u8282\u70b9\u3001\u9690\u85cf\u3001\u6c14\u6ce1\u63d0\u793a\u6846\u4e09\u79cd, \u5f53type\u4e3apopper\u65f6\uff0c\u4f1a\u81ea\u52a8\u62e6\u622a\u5b50\u5143\u7d20\u7684onClick\u4e8b\u4ef6, \u540c\u65f6\uff0c\u4e5f\u9700\u8981\u786e\u4fdd\u5b50\u8282\u70b9\u7b26\u5408<Popper />\u7ec4\u4ef6\u7684\u5b50\u8282\u70b9\u89c4\u5219 */\n  type?: AuthTypeKeys | AuthTypeEnum;\n  /** \u4f20\u9012\u7ed9\u9a8c\u8bc1\u5668\u7684\u989d\u5916\u53c2\u6570 */\n  extra?: any;\n  /**\n   * \u5b9a\u5236\u65e0\u6743\u9650\u65f6\u7684\u53cd\u9988\u6837\u5f0f\n   * @param rejectMeta - \u672a\u901a\u8fc7\u7684\u6743\u9650\u7684\u5177\u4f53\u4fe1\u606f\n   * @param props - \u7ec4\u4ef6\u63a5\u6536\u7684\u539f\u59cbprops\n   * @return - \u8fd4\u56de\u7528\u4e8e\u663e\u793a\u7684\u53cd\u9988\u8282\u70b9\n   * */\n  feedback?: (rejectMeta: ValidMeta[], props: AuthProps<S, V>) => React.ReactNode;\n  /** \u662f\u5426\u7981\u7528\uff0c\u7981\u7528\u65f6\u76f4\u63a5\u663e\u793a\u5b50\u8282\u70b9 */\n  disabled?: boolean;\n  /** \u5c40\u90e8\u9a8c\u8bc1\u5668 */\n  validators?: Validators<S>;\n  /** \u81ea\u5b9a\u4e49\u663e\u793a\u7684403 icon */\n  icon?: React.ReactNode;\n}\n\n// Auth\u7ec4\u4ef6\u5b9e\u4f8b\u8fd8\u5305\u542b\u4ee5\u4e0b\u5c5e\u6027\u548c\u65b9\u6cd5, \u901a\u8fc7Auth.xxx\u4f7f\u7528\ninterface RCAuth {\n  /** \u6267\u884c\u6743\u9650\u9a8c\u8bc1 */\n  auth: Auth;\n  /** \u521b\u5efa\u5e26\u6743\u9650\u68c0\u6d4b\u7684\u9ad8\u9636\u7ec4\u4ef6 */\n  withAuth: <P>(\n          conf: Omit<AuthProps<S, V>, 'children'>,\n  ) => (Component: React.ComponentType<P>) => React.FC<P>;\n  /** \u6743\u9650\u9a8c\u8bc1hook */\n  useAuth: UseAuth;\n}",lang:"tsx"}),l.a.createElement("h2",{id:"authpro"},l.a.createElement(r["AnchorLink"],{to:"#authpro","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"AuthPro"),l.a.createElement("p",null,"\u8fd9\u662f\u4e00\u79cd\u4e3a\u4e2d\u540e\u53f0\u9879\u76ee\u5f00\u53d1\u8bbe\u8ba1\u7684\u6743\u9650\u529f\u80fd\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u5927\u90e8\u5206\u529f\u80fd\u90fd\u56f4\u7ed5\u6743\u9650\u6765\u8fdb\u884c\uff0c\u6240\u4ee5\u4f1a\u9700\u8981\u4e00\u79cd\u66f4\u5bb9\u6613\u4ee5\u540e\u7aef\u6280\u672f\u96c6\u6210\u3001\u66f4\u5bb9\u6613\u4f7f\u7528\u3001\u66f4\u9002\u5408\u5904\u7406\u590d\u6742\u7e41\u91cd\u7cfb\u7edf\u7684\u6743\u9650\u9a8c\u8bc1\u7684\u65b9\u5f0f\u3002"),l.a.createElement("h3",{id:"\u7406\u89e3-auth-string"},l.a.createElement(r["AnchorLink"],{to:"#\u7406\u89e3-auth-string","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u7406\u89e3 auth string"),l.a.createElement("p",null,l.a.createElement("code",null,"auth string"),"\u662f\u4e00\u79cd\u7b80\u5316\u6743\u9650\u4e66\u5199\u7684\u65b9\u5f0f\uff0c\u662f\u6743\u9650\u5bf9\u8c61\u7684\u5b57\u7b26\u4e32\u8868\u793a."),l.a.createElement("p",null,"\u5176\u683c\u5f0f\u4e3a:"),l.a.createElement(u["a"],{code:"`name:keys`;",lang:"ts"}),l.a.createElement("br",null),l.a.createElement("ul",null,l.a.createElement("li",null,l.a.createElement("code",null,"name")," \u8868\u793a\u80fd\u4ee3\u8868\u67d0\u4e2a\u6743\u9650\u7684\u552f\u4e00\u540d\u79f0, \u5982\uff1a",l.a.createElement("code",null,"user"),"\u3001",l.a.createElement("code",null,"news"),"\u3001",l.a.createElement("code",null,"activity"),", \u5728\u591a\u6a21\u5757\u7684\u7cfb\u7edf\u4e2d\uff0c\u4f7f\u7528\u70b9\u6765\u5206\u5272\u5e76\u63cf\u8ff0\u8be6\u7ec6\u7684\u6a21\u5757\u540d\u79f0: ",l.a.createElement("code",null,"main.client.news")),l.a.createElement("li",null,l.a.createElement("code",null,"keys")," \u4e3a ",l.a.createElement("code",null,"crud")," \u8fd9\u6837\u7684\u5b57\u7b26\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5b57\u7b26\u8868\u793a\u4e00\u4e2a\u6743\u9650\u7684\u62e5\u6709\u60c5\u51b5\uff0c",l.a.createElement("code",null,"curd")," \u5206\u522b\u5bf9\u5e94\u529f\u80fd\u7684 \u589e\u52a0(Create)\u3001\u68c0\u7d22(Retrieve)\u3001\u66f4\u65b0(Update)\u548c\u5220\u9664(Delete)\u6743\u9650\uff0ckeys \u662f\u53ef\u4ee5\u7531\u7528\u6237\u81ea\u7531\u6269\u5c55\u7684\uff0c\u4f46\u662f",l.a.createElement("code",null,"crud"),"\u4e00\u822c\u6765\u8bf4\u5df2\u7ecf\u8db3\u591f\u63cf\u8ff0\u5927\u591a\u6570\u6743\u9650\u884c\u4e3a\u3002")),l.a.createElement("br",null),l.a.createElement("p",null,"\u5b9e\u9645\u4f7f\u7528\u65f6\u7684\u683c\u5f0f\u5927\u81f4\u5982\u4e0b:"),l.a.createElement(u["a"],{code:"`user:cd` // \u7528\u6237\u6a21\u5757\uff0c\u53ef\u7528\u6743\u9650\u4e3a\u589e\u52a0\u3001\u5220\u9664\n`news:cru` // \u65b0\u95fb\u6a21\u5757\uff0c\u53ef\u7528\u6743\u9650\u4e3a\u589e\u52a0\u3001\u67e5\u8be2\u3001\u66f4\u65b0\n`manage.activity:crua`; // \u7ba1\u7406\u7aef\u7684\u6d3b\u52a8\u6a21\u5757\uff0c\u53ef\u7528\u6743\u9650\u4e3a\u589e\u52a0\u3001\u67e5\u8be2\u3001\u66f4\u65b0\u3001\u5ba1\u6279(\u81ea\u5b9a\u4e49key)",lang:"ts"}),l.a.createElement("h3",{id:"\u57fa\u672c\u793a\u4f8b-1"},l.a.createElement(r["AnchorLink"],{to:"#\u57fa\u672c\u793a\u4f8b-1","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u57fa\u672c\u793a\u4f8b"),l.a.createElement("p",null,"\u901a\u8fc7",l.a.createElement("code",null,"createAuthPro()"),"\u521b\u5efa\u5b9e\u4f8b, \u4f7f\u7528",l.a.createElement("code",null,"AuthPro.setAuth()"),"\u6765\u66f4\u6539\u62e5\u6709\u7684\u6743\u9650, \u7136\u540e\u901a\u8fc7",l.a.createElement("code",null,"<AuthPro />"),"\u7ec4\u4ef6\u6765\u8fdb\u884c\u9a8c\u8bc1"),l.a.createElement("blockquote",null,l.a.createElement("p",null,l.a.createElement("code",null,"AuthPro"),"\u5e95\u5c42\u662f\u57fa\u4e8e\u5e38\u89c4",l.a.createElement("code",null,"Auth"),"\u7684\uff0c\u6240\u4ee5\u652f\u6301\u5b83\u7684\u7edd\u5927\u591a\u6570\u7528\u6cd5, \u6bd4\u5982\u57fa\u672c\u76f8\u540c\u7684\u53c2\u6570\u3001",l.a.createElement("code",null,"withAuth"),"\u3001",l.a.createElement("code",null,"useAuth"),"\u3001\u5b9a\u5236\u7b49\u7b49."))),l.a.createElement(c["default"],o["default"]["pro-base"].previewerProps,l.a.createElement(k,null)),l.a.createElement("div",{className:"markdown"},l.a.createElement("h3",{id:"api-\u901f\u89c8-1"},l.a.createElement(r["AnchorLink"],{to:"#api-\u901f\u89c8-1","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"api \u901f\u89c8"),l.a.createElement(u["a"],{code:"import { createSeed } from 'm78/seed';\nimport { createAuthPro } from 'm78/auth';\n\n// ###############################\n//            \u5b9e\u4f8b\u521b\u5efa\n// ###############################\nconst AuthPro = createAuthPro({\n  // \u9700\u8981\u4f20\u5165\u4e00\u4e2aseed\u63a7\u5236\u5185\u90e8\u72b6\u6001\n  seed: createSeed(),\n  // \u53ef\u9009\u7684\u8bbe\u7f6e\u521d\u59cb\u6743\u9650\n  auth: ['user:cru', 'article:d'],\n  // \u6269\u5c55curd\u4ee5\u5916\u7684\u989d\u5916key\n  customAuthKeysMap: {\n    /** key\u7684\u7b80\u5199\u540d\u79f0, \u5982c/r/u/d */\n    a: {\n      /** \u8868\u793a\u8be5\u7b80\u5199\u7684\u5b8c\u6574\u540d\u79f0, \u5982 c \u7684\u5b8c\u6574 name \u4e3a create */\n      name: 'audit',\n      /** \u6807\u9898 */\n      label: '\u5ba1\u6838',\n    },\n    p: {\n      name: 'publish',\n      label: '\u53d1\u5e03',\n    },\n  },\n  // \u4e3a\u6743\u9650\u540d\u8d4b\u4e88\u8bed\u4e49\u5316\u7684\u540d\u79f0, \u4f7f\u5176\u5728\u7528\u4e8e\u53cd\u9988\u65f6\u66f4\u53cb\u597d\n  authNameMap: {\n    user: '\u7528\u6237',\n    article: '\u6587\u7ae0',\n  },\n  // \u8bbe\u7f6e\u8bed\u8a00\n  lang: 'zh-CN',\n  // \u81ea\u5b9a\u8bed\u8a00\u914d\u7f6e, \u53ef\u7528\u4e8e\u8986\u76d6\u73b0\u6709\u914d\u7f6e\uff0c\u6216\u8005\u6269\u5145\n  languages: {\n    'zh-CN': {\n      noPermission: '\ud83d\ude25\u6ca1\u6709\u6743\u9650',\n    },\n  },\n});\n\n// ###############################\n//              api\n// ###############################\n\n// <AuthPro />\u672c\u8eab\u662f\u4e00\u4e2areact\u7ec4\u4ef6\uff0c\u5305\u542b\u4ee5\u4e0bprops, \u4e0e\u5e38\u89c4Auth\u975e\u5e38\u76f8\u4f3c\ninterface AuthProProps {\n  /**\n   * \u6743\u9650\u9a8c\u8bc1\u901a\u8fc7\u540e\u663e\u793a\u7684\u5185\u5bb9\n   * - \u5f53type\u4e3atooltip\u65f6\uff0c\u5fc5\u987b\u4f20\u5165\u5355\u4e2a\u5b50\u5143\u7d20\uff0c\u5e76\u4e14\u4fdd\u8bc1\u5176\u80fd\u6b63\u5e38\u63a5\u6536\u4e8b\u4ef6\n   * */\n  children: React.ReactElement | (() => React.ReactElement);\n  /** 'feedback' | \u53cd\u9988\u65b9\u5f0f\uff0c\u5206\u4e3a\u5360\u4f4d\u8282\u70b9\u3001\u9690\u85cf\u3001\u6c14\u6ce1\u63d0\u793a\u6846\u4e09\u79cd, \u5f53type\u4e3apopper\u65f6\uff0c\u4f1a\u81ea\u52a8\u62e6\u622a\u5b50\u5143\u7d20\u7684onClick\u4e8b\u4ef6, \u540c\u65f6\uff0c\u4e5f\u9700\u8981\u786e\u4fdd\u5b50\u8282\u70b9\u7b26\u5408<Popper />\u7ec4\u4ef6\u7684\u5b50\u8282\u70b9\u89c4\u5219 */\n  type?: AuthTypeKeys | AuthTypeEnum;\n  /** \u662f\u5426\u7981\u7528\uff0c\u7981\u7528\u65f6\u76f4\u63a5\u663e\u793a\u5b50\u8282\u70b9 */\n  disabled?: boolean;\n  /** \u5c40\u90e8\u9a8c\u8bc1\u5668 */\n  validators?: Validators<S>;\n  /** \u81ea\u5b9a\u4e49\u663e\u793a\u7684403 icon */\n  icon?: React.ReactNode;\n  /** \u671f\u671b\u7684\u6743\u9650 */\n  keys: AuthProStrings;\n  /**\n   * \u5b9a\u5236\u65e0\u6743\u9650\u65f6\u7684\u53cd\u9988\u6837\u5f0f\n   * @param rejectMeta - \u672a\u901a\u8fc7\u7684\u6743\u9650\u7684\u5177\u4f53\u4fe1\u606f\n   * @param props - \u7ec4\u4ef6\u63a5\u6536\u7684\u539f\u59cbprops\n   * @return - \u8fd4\u56de\u7528\u4e8e\u663e\u793a\u7684\u53cd\u9988\u8282\u70b9\n   * */\n  feedback?: (rejectMeta: AuthProValidMeta[], props: AuthProProps) => React.ReactNode;\n}\n\n// AuthPro\u7ec4\u4ef6\u5b9e\u4f8b\u8fd8\u5305\u542b\u4ee5\u4e0b\u5c5e\u6027\u548c\u65b9\u6cd5, \u901a\u8fc7AuthPro.xxx\u4f7f\u7528\ninterface AuthPro {\n  /** \u6743\u9650\u9a8c\u8bc1hook, \u53ef\u53c2\u8003\u5e38\u89c4Auth\u7684\u7528\u6cd5 */\n  useAuth: (keys: AuthProStrings) => AuthProValidMeta[] | null;\n  /** \u521b\u5efa\u5e26\u6743\u9650\u68c0\u6d4b\u7684\u9ad8\u9636\u7ec4\u4ef6, \u53ef\u53c2\u8003\u5e38\u89c4Auth\u7684\u7528\u6cd5 */\n  withAuth: <P>(\n    conf: Omit<AuthProProps, 'children'>,\n  ) => (Component: React.ComponentType<P>) => React.FC<P>;\n  /** \u8bbe\u7f6e\u5f53\u524d\u6743\u9650 */\n  setAuth: (auth: AuthProStrings) => void;\n  /** \u83b7\u53d6\u5f53\u524d\u6743\u9650 */\n  getAuth: () => AuthProStrings;\n  /** \u83b7\u53d6\u6743\u9650\u7684\u8be6\u7ec6\u5bf9\u8c61 */\n  getAuthDetail: () => AuthProDetailMap | null;\n  /** \u4f20\u5165\u6743\u9650\u5b57\u7b26\u6570\u7ec4\u8fdb\u884c\u9a8c\u8bc1 */\n  auth: (keys: AuthProStrings) => AuthProValidMeta[] | null;\n  /** \u6839\u636e\u5f53\u524d\u5b9e\u4f8b\u7684\u914d\u7f6e\u89e3\u6790\u4e00\u4e2aAuthProStrings\u5e76\u8fd4\u56de\u89e3\u6790\u5bf9\u8c61 */\n  parse: (keys: AuthProStrings) => AuthProDetailMap | null;\n  /** \u5b57\u7b26\u4e32\u5316AuthProDetailMap\u5e76\u8fd4\u56de\u6bcf\u4e2a\u6743\u9650\u7684AuthProStrings\u7ec4\u6210\u7684\u6570\u7ec4 */\n  stringify: (authMap: AuthProDetailMap) => AuthProStrings;\n  /** \u5185\u90e8\u4f7f\u7528\u7684\u5e38\u89c4\u7248auth\u5b9e\u4f8b */\n  authInstance: Auth<_AuthSeedProState>;\n}",lang:"tsx"}),l.a.createElement("h3",{id:"\u4e0e\u540e\u7aef\u96c6\u6210"},l.a.createElement(r["AnchorLink"],{to:"#\u4e0e\u540e\u7aef\u96c6\u6210","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u4e0e\u540e\u7aef\u96c6\u6210"),l.a.createElement("p",null,"\u6709\u4e24\u79cd\u53ef\u884c\u7684\u65b9\u5f0f\u6765\u96c6\u6210\u5230\u540e\u7aef\u6743\u9650\u7cfb\u7edf\u4e2d\uff0c\u6839\u636e\u4f60\u7684\u9879\u76ee\u60c5\u51b5\u81ea\u884c\u9009\u62e9\uff1a"),l.a.createElement("ol",null,l.a.createElement("li",null,"\u6839\u636e\u73b0\u6709\u7cfb\u7edf\u7684\u6743\u9650 api \u63a5\u53e3\u7f16\u5199\u672c\u5730\u8f6c\u6362\u5668\u6765\u5c06\u5176\u8f6c\u6362\u6210\u672c\u5e93\u671f\u671b\u7684\u6743\u9650\u63cf\u8ff0\u5bf9\u8c61(\u65b9\u6848 2 \u4e2d\u7684\u4efb\u610f\u4e00\u79cd)."),l.a.createElement("li",null,"\u540e\u7aef\u76f4\u63a5\u6839\u636e\u672c\u5e93\u63d0\u4f9b\u7684\u6743\u9650\u6570\u636e\u683c\u5f0f\u7f16\u5199 api \u63a5\u53e3.")),l.a.createElement("p",null,"\u4ee5\u4e0b\u662f\u672c\u5e93\u671f\u671b\u7684\u4e24\u79cd\u6743\u9650\u63cf\u8ff0\u65b9\u5f0f:"),l.a.createElement("p",null,l.a.createElement("strong",null,"\u5b57\u7b26\u98ce\u683c")),l.a.createElement("p",null,"\u63a8\u8350\u7684\u683c\u5f0f\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u3002"),l.a.createElement(u["a"],{code:"['user:cr', 'news:crud', 'activity:cud', 'manage:c'];",lang:"ts"}),l.a.createElement("p",null,l.a.createElement("strong",null,"JSON \u98ce\u683c")),l.a.createElement("p",null,"\u4f7f\u7528\u6b64\u683c\u5f0f\u65f6\uff0c\u9996\u5148\u901a\u8fc7 api \u63a5\u6536\u5230\u6b64\u683c\u5f0f\u7684\u8fd4\u56de, \u7136\u540e\u4f7f\u7528",l.a.createElement("code",null,"AuthPro.stringify(map)"),"\u5c06\u5176\u8f6c\u6362\u4e3a\u5b57\u7b26\u98ce\u683c\u7684\u6743\u9650\u6570\u636e\u6765\u4f7f\u7528\u3002"),l.a.createElement(u["a"],{code:'{\n  "user": {\n    "create": true,\n    "retrieve": true\n  },\n  "news": {\n    "create": true,\n    "retrieve": true,\n    "update": true,\n    "delete": true\n  },\n  "activity": {\n    "create": true,\n    "update": true,\n    "delete": true\n  },\n  "manage": {\n    "create": true\n  }\n}',lang:"json"}),l.a.createElement("h3",{id:"\u81ea\u5b9a\u4e49-key"},l.a.createElement(r["AnchorLink"],{to:"#\u81ea\u5b9a\u4e49-key","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u81ea\u5b9a\u4e49 key"),l.a.createElement("p",null,"\u5982\u679c\u5185\u7f6e\u7684",l.a.createElement("code",null,"crud"),"\u56db\u79cd key \u4e0d\u8db3\u4ee5\u63cf\u8ff0\u5f53\u524d\u7684\u9879\u76ee\u6743\u9650\uff0c\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u6269\u5c55\uff0c\u64cd\u4f5c\u65b9\u5f0f\u5982\u4e0b:"),l.a.createElement(u["a"],{code:"// \u521b\u5efa\u5b9e\u4f8b\u65f6\u4f20\u5165\u989d\u5916\u914d\u7f6ecustomAuthKeysMap\nconst AuthPro = createAuthPro({\n  seed: createSeed(),\n  customAuthKeysMap: {\n    /** key\u7684\u7b80\u5199\u540d\u79f0, \u5982c/r/u/d */\n    a: {\n      /** \u8868\u793a\u8be5\u7b80\u5199\u7684\u5b8c\u6574\u540d\u79f0, \u5982 c \u7684\u5b8c\u6574 name \u4e3a create */\n      name: 'audit',\n      /** \u6807\u9898 */\n      label: '\u5ba1\u6838',\n    },\n    p: {\n      name: 'publish',\n      label: '\u53d1\u5e03',\n    },\n  },\n});",lang:"ts"}),l.a.createElement("p",null,"\u7136\u540e\uff0c\u4f60\u5c31\u53ef\u4ee5\u50cf\u4f7f\u7528\u5185\u7f6e\u7684 key \u4e00\u6837\u4f7f\u7528\u5b83\u4eec\u4e86:"),l.a.createElement(u["a"],{code:"AuthPro.auth(['user:cruda', 'news:cap']);",lang:"ts"}),l.a.createElement("h3",{id:"\u7528\u6237\u7aef\u7684-rbac"},l.a.createElement(r["AnchorLink"],{to:"#\u7528\u6237\u7aef\u7684-rbac","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"\u7528\u6237\u7aef\u7684 RBAC"),l.a.createElement("p",null,"RBAC(role based access control)\u662f\u4e00\u79cd\u975e\u5e38\u5e38\u89c1\u7684\u6743\u9650\u63a7\u5236\u65b9\u5f0f\uff0c\u5176\u6838\u5fc3\u601d\u60f3\u662f\u5c06\u9700\u8981\u63a7\u5236\u8bbf\u95ee\u7684\u529f\u80fd\u5f53\u505a\u8d44\u6e90\uff0c\u518d\u5c06\u8fd9\u4e9b\u8d44\u6e90\u4e0e\u89d2\u8272\u8fdb\u884c\u7ed1\u5b9a\uff0c\u6700\u540e\u6839\u636e\u89d2\u8272\u62e5\u6709\u7684\u6743\u9650\u6765\u8fdb\u884c\u6743\u9650\u5224\u5b9a\u3002"),l.a.createElement("p",null,"\u901a\u5e38\u540e\u7aef\u9879\u76ee\u7684\u6743\u9650\u5224\u5b9a\u6d41\u7a0b\u4e3a:"),l.a.createElement("ol",null,l.a.createElement("li",null,"\u5f00\u53d1\u4e00\u4e2a\u9700\u8981\u6743\u9650\u7684\u529f\u80fd"),l.a.createElement("li",null,"\u83b7\u53d6\u5f53\u524d\u7528\u6237\u6240\u5c5e\u7684\u89d2\u8272(\u4e00\u4e2a\u7528\u6237\u5f80\u5f80\u4f1a\u62e5\u6709\u591a\u4e2a\u89d2\u8272, \u901a\u5e38\u5c06\u5176\u79f0\u4e3a\u89d2\u8272\u7ec4)"),l.a.createElement("li",null,"\u83b7\u53d6\u8fd9\u4e9b\u89d2\u8272\u5305\u542b\u7684\u6743\u9650\u8d44\u6e90"),l.a.createElement("li",null,"\u5224\u65ad\u662f\u5426\u5305\u542b\u5f00\u53d1\u8fd9\u4e2a\u529f\u80fd\u6240\u5fc5\u8981\u7684\u8d44\u6e90")),l.a.createElement("p",null,"\u800c\u5bf9\u4e8e\u7528\u6237\u7aef\uff0c\u5f88\u591a\u7cfb\u7edf\u7684\u6743\u9650\u5b9e\u73b0\u90fd\u662f\u7528\u4ee5\u4e0b\u65b9\u5f0f\u8fdb\u884c\u7684:"),l.a.createElement(u["a"],{code:"<Auth auth={['editor', 'admin']}>\n  <Button>\u53d1\u5e03\u6587\u7ae0</Button>\n</Auth>",lang:"tsx"}),l.a.createElement("p",null,"\u8fd9\u5176\u5b9e\u662f\u4e00\u79cd\u4e0d\u53ef\u9760\u7684\u9a8c\u8bc1\u65b9\u5f0f\uff0c\u8003\u8651\u4e00\u70b9\uff0c\u89d2\u8272\u62e5\u6709\u7684\u6743\u9650\u5f80\u5f80\u662f\u5177\u6709\u52a8\u6001\u6027\u7684\uff0c\u968f\u65f6\u53ef\u80fd\u53d8\u66f4\uff0c\u5982\u679c\u4ee3\u7801\u4e2d\u4f9d\u8d56\u89d2\u8272\u6765\u8fdb\u884c\u6743\u9650\u5224\u5b9a\uff0c\u5f53\u89d2\u8272\u62e5\u6709\u7684\u6743\u9650\u53d8\u66f4\u540e\uff0c\u8fd9\u6bb5\u4ee3\u7801\u53ef\u80fd\u4f1a\u4ea7\u751f\u610f\u6599\u4e4b\u5916\u7684\u9519\u8bef\u3002"),l.a.createElement("p",null,"\u800c\u540e\u7aef\u4ee3\u7801\u4e2d\u8fdb\u884c\u6700\u7ec8\u68c0\u6d4b\u7684\u662f\u7528\u6237\u6240\u5c5e\u89d2\u8272\u5bf9\u5e94\u7684\u6240\u6709\u6743\u9650\u8d44\u6e90\uff0c\u6240\u4ee5\u4e0d\u4f1a\u5b58\u5728\u6b64\u95ee\u9898\u3002"),l.a.createElement("p",null,"\u6240\u4ee5\uff0c",l.a.createElement("code",null,"AuthPro")," \u53bb\u6389\u4e86\u89d2\u8272\u8fd9\u4e00\u6982\u5ff5\uff0c\u4f7f\u7528\u7cbe\u786e\u7684\u6743\u9650\u6765\u8fdb\u884c\u6743\u9650\u5224\u5b9a\uff0c\u76f8\u5f53\u4e8e\u76f4\u63a5\u91c7\u7528\u4e0a\u9762\u7684\u7b2c 1 \u6b65\u548c\u7b2c 4 \u6b65\u6765\u5b8c\u6210\u6743\u9650\u7684\u9a8c\u8bc1:"),l.a.createElement(u["a"],{code:"<Auth auth={['article:cru']}>\n  <Button>\u53d1\u5e03\u6587\u7ae0</Button>\n</Auth>",lang:"tsx"}),l.a.createElement("br",null),l.a.createElement("h3",{id:"string-\u4e0e-map"},l.a.createElement(r["AnchorLink"],{to:"#string-\u4e0e-map","aria-hidden":"true",tabIndex:-1},l.a.createElement("span",{className:"icon icon-link"})),"string \u4e0e map"),l.a.createElement("p",null,l.a.createElement("code",null,"auth string"),"(\u63cf\u8ff0\u6743\u9650\u7684\u5b57\u7b26\u4e32)\u4e0e",l.a.createElement("code",null,"auth map"),"(\u63cf\u8ff0\u6743\u9650\u7684\u5bf9\u8c61)\u4e4b\u95f4\u80fd\u591f\u76f8\u4e92\u8f6c\u6362"),l.a.createElement("p",null,"\u8fd9\u7c7b\u4f3c\u4e8e",l.a.createElement("code",null,"URL"),"\u4e2d",l.a.createElement("code",null,"query"),"\u7684\u6982\u5ff5, \u4f8b\u5982\u4ee5\u4e0b\u5bf9\u8c61\u53ef\u4ee5\u7528\u5b57\u7b26",l.a.createElement("code",null,"?name=lxj&like=code&like=game"),"\u8868\u793a:"),l.a.createElement(u["a"],{code:"const query = {\n  name: 'lxj',\n  like: ['code', 'game'],\n};",lang:"ts"}),l.a.createElement("p",null,"\u800c ",l.a.createElement("code",null,"['user:crud', 'news:cr']")," \u53ef\u4ee5\u8868\u793a\u5982\u4e0b\u5bf9\u8c61:"),l.a.createElement(u["a"],{code:"const authMap = {\n  user: {\n    create: true,\n    retrieve: true,\n    update: true,\n    delete: true,\n  },\n  user: {\n    create: true,\n    retrieve: true,\n  },\n};",lang:"ts"}),l.a.createElement("p",null,"\u901a\u8fc7",l.a.createElement("code",null,"AuthPro.stringify()"),"\u548c",l.a.createElement("code",null,"AuthPro.parse()"),"\uff0c\u4f60\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u5728\u8fd9\u4e24\u8005\u95f4\u8fdb\u884c\u8f6c\u6362")))))}}]);